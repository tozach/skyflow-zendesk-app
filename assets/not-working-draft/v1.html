<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!--   See Using Zendesk Garden:
    https://developer.zendesk.com/apps/docs/developer-guide/setup#using-zendesk-garden
    https://garden.zendesk.com/css-components/bedrock/
    https://garden.zendesk.com/css-components/utilities/typography/
   -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/combine/npm/@zendeskgarden/css-bedrock@7.0.21,npm/@zendeskgarden/css-utilities@4.3.0">
</head>
<body>
  <h2 class="u-semibold u-fs-xl">Hello, <span id="name">World</span>!</h2>
    <div id="content">
      <!-- Other content -->

      <!-- Detokenize Button -->
      <button id="detokenize-button">Detokenize</button>

      <!-- Optionally, you can add an element to display results or messages -->
      <div id="result"></div>
    </div>
  <script src="https://static.zdassets.com/zendesk_app_framework_sdk/2.0/zaf_sdk.min.js"></script>
  <script>

    var client = ZAFClient.init();  
    client.invoke("resize", { width: "100%", height: "200px" });
    
    async function displayUserName() {    
      const response = await client.get('ticket.requester.name');
      const name = response["ticket.requester.name"];
      const span = document.getElementById("name");
      span.innerText = name;  
    }
    displayUserName();

    document.getElementById('detokenize-button').addEventListener('click', function() {
            if (userEmail) {
                // Call your backend endpoint for detokenization
                fetch('http://localhost:3000/detokenize', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email: userEmail }),
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Detokenized Data:', data);
                    // Handle detokenized data here
                })
                .catch((error) => {
                    console.error('Error:', error);
                });
            } else {
                console.error('User email not found');
            }
        });

  </script>
</body>
</html>